#' @title Utility function for parsing timeout argument \code{parse_timeout}
#' @param x A data frame generated by Prometheus query
#' @rdname utilities
#' @importFrom checkmate assert_data_frame

format_metrics_data <- function(x) {
  # Check if passed object is a data frame of required characteristics
  checkmate::assert_data_frame(x = x,
                               min.rows = 1,
                               min.cols = 5)

  within.data.frame(data = setNames(
    object = x,
    nm = c("metric", "instance", "job", "timestamp", "value")
  ),
  expr = {
    port = as.integer(gsub(pattern = "(.*):(.*)",
                replacement = "\\2",
                x = instance))

    instance = gsub(pattern = "(.*):(.*)",
                    replacement = "\\1",
                    x = instance)

    value = trimws(as.integer(value))
  })
}
